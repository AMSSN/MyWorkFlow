cmake_minimum_required(VERSION 3.25)
project(LMTRT)

set(CMAKE_CXX_STANDARD 11)
# ğŸ‘‡ æ·»åŠ è¿™ä¸€è¡Œï¼šè®© Windows è‡ªåŠ¨å¯¼å‡ºæ‰€æœ‰ç¬¦å·
set(CMAKE_WINDOWS_EXPORT_ALL_SYMBOLS ON)

add_library(LMTRT SHARED LMTRT.cpp)


cmake_minimum_required(VERSION 3.10)
project(OnnxToTrt)

# é…ç½®TensorRTè·¯å¾„ (æ ¹æ®å®é™…å®‰è£…è·¯å¾„ä¿®æ”¹)
set(TENSORRT_ROOT "/usr/local/tensorrt" CACHE PATH "TensorRT installation directory")

# è®¾ç½®åŒ…å«è·¯å¾„å’Œåº“è·¯å¾„
include_directories(${TENSORRT_ROOT}/include)
link_directories(${TENSORRT_ROOT}/lib)

# åˆ›å»ºDLL
add_library(onnx_to_trt SHARED
        src/onnx_to_trt.cpp
        include/onnx_to_trt.h
        )

# è®¾ç½®C++æ ‡å‡†
set_target_properties(onnx_to_trt PROPERTIES
        CXX_STANDARD 17
        CXX_STANDARD_REQUIRED ON
        )

# é“¾æ¥TensorRTæ ¸å¿ƒåº“
target_link_libraries(onnx_to_trt
        nvinfer
        nvinfer_plugin
        onnx
        onnx_proto
        )

# ä¸ºWindowsè®¾ç½®å¯¼å‡ºç¬¦å·
if(WIN32)
    set_target_properties(onnx_to_trt PROPERTIES
            COMPILE_DEFINITIONS "ONNX_TO_TRT_EXPORTS"
            )
endif()

# å®‰è£…å¤´æ–‡ä»¶
install(TARGETS onnx_to_trt
        EXPORT onnx_to_trtTargets
        INCLUDES DESTINATION include
        ARCHIVE DESTINATION lib
        LIBRARY DESTINATION lib
        RUNTIME DESTINATION bin
        )